"use strict";
/*!
 * Copyright 2019 Omar Tawfik. Please see LICENSE file at the root of this repository.
 */
Object.defineProperty(exports, "__esModule", { value: true });
function analyzeActions(document, bag) {
    var actions = new Set(document.actions.map(function (action) { return action.name; }));
    document.workflows.forEach(function (parent) {
        if (parent.resolves) {
            var localActions_1 = new Set();
            parent.resolves.actions.forEach(function (action) {
                if (!actions.has(action.value)) {
                    bag.actionDoesNotExist(action.value, action.syntax.range);
                }
                if (localActions_1.has(action.value)) {
                    bag.duplicateActions(action.value, action.syntax.range);
                }
                else {
                    localActions_1.add(action.value);
                }
            });
        }
    });
    document.actions.forEach(function (parent) {
        if (parent.needs) {
            var localActions_2 = new Set();
            parent.needs.actions.forEach(function (action) {
                if (!actions.has(action.value)) {
                    bag.actionDoesNotExist(action.value, action.syntax.range);
                }
                if (localActions_2.has(action.value)) {
                    bag.duplicateActions(action.value, action.syntax.range);
                }
                else {
                    localActions_2.add(action.value);
                }
            });
        }
    });
}
exports.analyzeActions = analyzeActions;

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hbmFseXNpcy9hY3Rpb25zLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQTs7R0FFRzs7QUFLSCxTQUFnQixjQUFjLENBQUMsUUFBdUIsRUFBRSxHQUFrQjtJQUN4RSxJQUFNLE9BQU8sR0FBRyxJQUFJLEdBQUcsQ0FBUyxRQUFRLENBQUMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxVQUFBLE1BQU0sSUFBSSxPQUFBLE1BQU0sQ0FBQyxJQUFJLEVBQVgsQ0FBVyxDQUFDLENBQUMsQ0FBQztJQUU3RSxRQUFRLENBQUMsU0FBUyxDQUFDLE9BQU8sQ0FBQyxVQUFBLE1BQU07UUFDL0IsSUFBSSxNQUFNLENBQUMsUUFBUSxFQUFFO1lBQ25CLElBQU0sY0FBWSxHQUFHLElBQUksR0FBRyxFQUFVLENBQUM7WUFDdkMsTUFBTSxDQUFDLFFBQVEsQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDLFVBQUEsTUFBTTtnQkFDcEMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxFQUFFO29CQUM5QixHQUFHLENBQUMsa0JBQWtCLENBQUMsTUFBTSxDQUFDLEtBQUssRUFBRSxNQUFNLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxDQUFDO2lCQUMzRDtnQkFDRCxJQUFJLGNBQVksQ0FBQyxHQUFHLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxFQUFFO29CQUNsQyxHQUFHLENBQUMsZ0JBQWdCLENBQUMsTUFBTSxDQUFDLEtBQUssRUFBRSxNQUFNLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxDQUFDO2lCQUN6RDtxQkFBTTtvQkFDTCxjQUFZLENBQUMsR0FBRyxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsQ0FBQztpQkFDaEM7WUFDSCxDQUFDLENBQUMsQ0FBQztTQUNKO0lBQ0gsQ0FBQyxDQUFDLENBQUM7SUFFSCxRQUFRLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQyxVQUFBLE1BQU07UUFDN0IsSUFBSSxNQUFNLENBQUMsS0FBSyxFQUFFO1lBQ2hCLElBQU0sY0FBWSxHQUFHLElBQUksR0FBRyxFQUFVLENBQUM7WUFDdkMsTUFBTSxDQUFDLEtBQUssQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDLFVBQUEsTUFBTTtnQkFDakMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxFQUFFO29CQUM5QixHQUFHLENBQUMsa0JBQWtCLENBQUMsTUFBTSxDQUFDLEtBQUssRUFBRSxNQUFNLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxDQUFDO2lCQUMzRDtnQkFFRCxJQUFJLGNBQVksQ0FBQyxHQUFHLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxFQUFFO29CQUNsQyxHQUFHLENBQUMsZ0JBQWdCLENBQUMsTUFBTSxDQUFDLEtBQUssRUFBRSxNQUFNLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxDQUFDO2lCQUN6RDtxQkFBTTtvQkFDTCxjQUFZLENBQUMsR0FBRyxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsQ0FBQztpQkFDaEM7WUFDSCxDQUFDLENBQUMsQ0FBQztTQUNKO0lBQ0gsQ0FBQyxDQUFDLENBQUM7QUFDTCxDQUFDO0FBbkNELHdDQW1DQyIsImZpbGUiOiJzcmMvYW5hbHlzaXMvYWN0aW9ucy5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qIVxuICogQ29weXJpZ2h0IDIwMTkgT21hciBUYXdmaWsuIFBsZWFzZSBzZWUgTElDRU5TRSBmaWxlIGF0IHRoZSByb290IG9mIHRoaXMgcmVwb3NpdG9yeS5cbiAqL1xuXG5pbXBvcnQgeyBEaWFnbm9zdGljQmFnIH0gZnJvbSBcIi4uL3V0aWwvZGlhZ25vc3RpY3NcIjtcbmltcG9ydCB7IEJvdW5kRG9jdW1lbnQgfSBmcm9tIFwiLi4vYmluZGluZy9ib3VuZC1ub2Rlc1wiO1xuXG5leHBvcnQgZnVuY3Rpb24gYW5hbHl6ZUFjdGlvbnMoZG9jdW1lbnQ6IEJvdW5kRG9jdW1lbnQsIGJhZzogRGlhZ25vc3RpY0JhZyk6IHZvaWQge1xuICBjb25zdCBhY3Rpb25zID0gbmV3IFNldDxzdHJpbmc+KGRvY3VtZW50LmFjdGlvbnMubWFwKGFjdGlvbiA9PiBhY3Rpb24ubmFtZSkpO1xuXG4gIGRvY3VtZW50LndvcmtmbG93cy5mb3JFYWNoKHBhcmVudCA9PiB7XG4gICAgaWYgKHBhcmVudC5yZXNvbHZlcykge1xuICAgICAgY29uc3QgbG9jYWxBY3Rpb25zID0gbmV3IFNldDxzdHJpbmc+KCk7XG4gICAgICBwYXJlbnQucmVzb2x2ZXMuYWN0aW9ucy5mb3JFYWNoKGFjdGlvbiA9PiB7XG4gICAgICAgIGlmICghYWN0aW9ucy5oYXMoYWN0aW9uLnZhbHVlKSkge1xuICAgICAgICAgIGJhZy5hY3Rpb25Eb2VzTm90RXhpc3QoYWN0aW9uLnZhbHVlLCBhY3Rpb24uc3ludGF4LnJhbmdlKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAobG9jYWxBY3Rpb25zLmhhcyhhY3Rpb24udmFsdWUpKSB7XG4gICAgICAgICAgYmFnLmR1cGxpY2F0ZUFjdGlvbnMoYWN0aW9uLnZhbHVlLCBhY3Rpb24uc3ludGF4LnJhbmdlKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBsb2NhbEFjdGlvbnMuYWRkKGFjdGlvbi52YWx1ZSk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cbiAgfSk7XG5cbiAgZG9jdW1lbnQuYWN0aW9ucy5mb3JFYWNoKHBhcmVudCA9PiB7XG4gICAgaWYgKHBhcmVudC5uZWVkcykge1xuICAgICAgY29uc3QgbG9jYWxBY3Rpb25zID0gbmV3IFNldDxzdHJpbmc+KCk7XG4gICAgICBwYXJlbnQubmVlZHMuYWN0aW9ucy5mb3JFYWNoKGFjdGlvbiA9PiB7XG4gICAgICAgIGlmICghYWN0aW9ucy5oYXMoYWN0aW9uLnZhbHVlKSkge1xuICAgICAgICAgIGJhZy5hY3Rpb25Eb2VzTm90RXhpc3QoYWN0aW9uLnZhbHVlLCBhY3Rpb24uc3ludGF4LnJhbmdlKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChsb2NhbEFjdGlvbnMuaGFzKGFjdGlvbi52YWx1ZSkpIHtcbiAgICAgICAgICBiYWcuZHVwbGljYXRlQWN0aW9ucyhhY3Rpb24udmFsdWUsIGFjdGlvbi5zeW50YXgucmFuZ2UpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGxvY2FsQWN0aW9ucy5hZGQoYWN0aW9uLnZhbHVlKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuICB9KTtcbn1cbiJdfQ==
