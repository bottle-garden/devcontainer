"use strict";
/*!
 * Copyright 2019 Omar Tawfik. Please see LICENSE file at the root of this repository.
 */
var __extends = (this && this.__extends) || (function () {
    var extendStatics = function (d, b) {
        extendStatics = Object.setPrototypeOf ||
            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
        return extendStatics(d, b);
    };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var __read = (this && this.__read) || function (o, n) {
    var m = typeof Symbol === "function" && o[Symbol.iterator];
    if (!m) return o;
    var i = m.call(o), r, ar = [], e;
    try {
        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);
    }
    catch (error) { e = { error: error }; }
    finally {
        try {
            if (r && !r.done && (m = i["return"])) m.call(i);
        }
        finally { if (e) throw e.error; }
    }
    return ar;
};
var __spread = (this && this.__spread) || function () {
    for (var ar = [], i = 0; i < arguments.length; i++) ar = ar.concat(__read(arguments[i]));
    return ar;
};
Object.defineProperty(exports, "__esModule", { value: true });
var tokens_1 = require("../scanning/tokens");
var vscode_languageserver_types_1 = require("vscode-languageserver-types");
var ranges_1 = require("../util/ranges");
var SyntaxKind;
(function (SyntaxKind) {
    // Top level
    SyntaxKind[SyntaxKind["Document"] = 0] = "Document";
    SyntaxKind[SyntaxKind["Version"] = 1] = "Version";
    SyntaxKind[SyntaxKind["Block"] = 2] = "Block";
    // Strings
    SyntaxKind[SyntaxKind["StringProperty"] = 3] = "StringProperty";
    // Arrays
    SyntaxKind[SyntaxKind["ArrayProperty"] = 4] = "ArrayProperty";
    SyntaxKind[SyntaxKind["ArrayItem"] = 5] = "ArrayItem";
    // Objects
    SyntaxKind[SyntaxKind["ObjectProperty"] = 6] = "ObjectProperty";
    SyntaxKind[SyntaxKind["ObjectMember"] = 7] = "ObjectMember";
})(SyntaxKind = exports.SyntaxKind || (exports.SyntaxKind = {}));
function assertTokenKind(token) {
    var acceptedKinds = [];
    for (var _i = 1; _i < arguments.length; _i++) {
        acceptedKinds[_i - 1] = arguments[_i];
    }
    if (token && token.kind !== tokens_1.TokenKind.Missing && !acceptedKinds.includes(token.kind)) {
        throw new Error("Token was initialized with an invalid '" + tokens_1.getTokenDescription(token.kind) + "' kind.");
    }
}
function combineRange() {
    var items = [];
    for (var _i = 0; _i < arguments.length; _i++) {
        items[_i] = arguments[_i];
    }
    var validRanges = items.filter(function (item) { return !!item; }).map(function (item) { return item.range; });
    if (!validRanges.length) {
        return vscode_languageserver_types_1.Range.create(0, 0, 0, 0);
    }
    validRanges.sort(function (a, b) { return ranges_1.comparePositions(a.start, b.start); });
    return vscode_languageserver_types_1.Range.create(validRanges[0].start, validRanges[validRanges.length - 1].end);
}
var BaseSyntaxNode = /** @class */ (function () {
    function BaseSyntaxNode(kind) {
        this.kind = kind;
    }
    Object.defineProperty(BaseSyntaxNode.prototype, "range", {
        get: function () {
            if (!this.lazyRange) {
                this.lazyRange = this.calculateRange();
            }
            return this.lazyRange;
        },
        enumerable: true,
        configurable: true
    });
    return BaseSyntaxNode;
}());
exports.BaseSyntaxNode = BaseSyntaxNode;
var DocumentSyntax = /** @class */ (function (_super) {
    __extends(DocumentSyntax, _super);
    function DocumentSyntax(versions, blocks, commentsAfter) {
        var _this = _super.call(this, SyntaxKind.Document) || this;
        _this.versions = versions;
        _this.blocks = blocks;
        _this.commentsAfter = commentsAfter;
        return _this;
    }
    DocumentSyntax.prototype.calculateRange = function () {
        return combineRange.apply(void 0, __spread(this.versions, this.blocks, this.commentsAfter));
    };
    return DocumentSyntax;
}(BaseSyntaxNode));
exports.DocumentSyntax = DocumentSyntax;
var VersionSyntax = /** @class */ (function (_super) {
    __extends(VersionSyntax, _super);
    function VersionSyntax(version, equal, integer) {
        var _this = _super.call(this, SyntaxKind.Version) || this;
        _this.version = version;
        _this.equal = equal;
        _this.integer = integer;
        assertTokenKind(version, tokens_1.TokenKind.VersionKeyword);
        assertTokenKind(equal, tokens_1.TokenKind.Equal);
        assertTokenKind(integer, tokens_1.TokenKind.IntegerLiteral);
        return _this;
    }
    VersionSyntax.prototype.calculateRange = function () {
        return combineRange(this.version, this.equal, this.integer);
    };
    return VersionSyntax;
}(BaseSyntaxNode));
exports.VersionSyntax = VersionSyntax;
var BlockSyntax = /** @class */ (function (_super) {
    __extends(BlockSyntax, _super);
    function BlockSyntax(type, name, openBracket, properties, closeBracket) {
        var _this = _super.call(this, SyntaxKind.Block) || this;
        _this.type = type;
        _this.name = name;
        _this.openBracket = openBracket;
        _this.properties = properties;
        _this.closeBracket = closeBracket;
        assertTokenKind(type, tokens_1.TokenKind.ActionKeyword, tokens_1.TokenKind.WorkflowKeyword);
        assertTokenKind(name, tokens_1.TokenKind.StringLiteral);
        assertTokenKind(openBracket, tokens_1.TokenKind.LeftCurlyBracket);
        assertTokenKind(closeBracket, tokens_1.TokenKind.RightCurlyBracket);
        return _this;
    }
    BlockSyntax.prototype.calculateRange = function () {
        return combineRange.apply(void 0, __spread([this.type, this.name, this.openBracket], this.properties, [this.closeBracket]));
    };
    return BlockSyntax;
}(BaseSyntaxNode));
exports.BlockSyntax = BlockSyntax;
var BasePropertySyntax = /** @class */ (function (_super) {
    __extends(BasePropertySyntax, _super);
    function BasePropertySyntax(kind, key, equal) {
        var _this = _super.call(this, kind) || this;
        _this.key = key;
        _this.equal = equal;
        assertTokenKind(key, tokens_1.TokenKind.OnKeyword, tokens_1.TokenKind.ResolvesKeyword, tokens_1.TokenKind.UsesKeyword, tokens_1.TokenKind.NeedsKeyword, tokens_1.TokenKind.RunsKeyword, tokens_1.TokenKind.ArgsKeyword, tokens_1.TokenKind.EnvKeyword, tokens_1.TokenKind.SecretsKeyword);
        assertTokenKind(equal, tokens_1.TokenKind.Equal);
        return _this;
    }
    return BasePropertySyntax;
}(BaseSyntaxNode));
exports.BasePropertySyntax = BasePropertySyntax;
var StringPropertySyntax = /** @class */ (function (_super) {
    __extends(StringPropertySyntax, _super);
    function StringPropertySyntax(key, equal, value) {
        var _this = _super.call(this, SyntaxKind.StringProperty, key, equal) || this;
        _this.value = value;
        assertTokenKind(value, tokens_1.TokenKind.StringLiteral);
        return _this;
    }
    StringPropertySyntax.prototype.calculateRange = function () {
        return combineRange(this.key, this.equal, this.value);
    };
    return StringPropertySyntax;
}(BasePropertySyntax));
exports.StringPropertySyntax = StringPropertySyntax;
var ArrayPropertySyntax = /** @class */ (function (_super) {
    __extends(ArrayPropertySyntax, _super);
    function ArrayPropertySyntax(key, equal, openBracket, items, closeBracket) {
        var _this = _super.call(this, SyntaxKind.ArrayProperty, key, equal) || this;
        _this.openBracket = openBracket;
        _this.items = items;
        _this.closeBracket = closeBracket;
        assertTokenKind(openBracket, tokens_1.TokenKind.LeftSquareBracket);
        assertTokenKind(closeBracket, tokens_1.TokenKind.RightSquareBracket);
        return _this;
    }
    ArrayPropertySyntax.prototype.calculateRange = function () {
        return combineRange.apply(void 0, __spread([this.openBracket], this.items, [this.closeBracket]));
    };
    return ArrayPropertySyntax;
}(BasePropertySyntax));
exports.ArrayPropertySyntax = ArrayPropertySyntax;
var ArrayItemSyntax = /** @class */ (function (_super) {
    __extends(ArrayItemSyntax, _super);
    function ArrayItemSyntax(value, comma) {
        var _this = _super.call(this, SyntaxKind.ArrayItem) || this;
        _this.value = value;
        _this.comma = comma;
        assertTokenKind(value, tokens_1.TokenKind.StringLiteral);
        assertTokenKind(comma, tokens_1.TokenKind.Comma);
        return _this;
    }
    ArrayItemSyntax.prototype.calculateRange = function () {
        return combineRange(this.value, this.comma);
    };
    return ArrayItemSyntax;
}(BaseSyntaxNode));
exports.ArrayItemSyntax = ArrayItemSyntax;
var ObjectPropertySyntax = /** @class */ (function (_super) {
    __extends(ObjectPropertySyntax, _super);
    function ObjectPropertySyntax(key, equal, openBracket, members, closeBracket) {
        var _this = _super.call(this, SyntaxKind.ObjectProperty, key, equal) || this;
        _this.openBracket = openBracket;
        _this.members = members;
        _this.closeBracket = closeBracket;
        assertTokenKind(openBracket, tokens_1.TokenKind.LeftCurlyBracket);
        assertTokenKind(closeBracket, tokens_1.TokenKind.RightCurlyBracket);
        return _this;
    }
    ObjectPropertySyntax.prototype.calculateRange = function () {
        return combineRange.apply(void 0, __spread([this.openBracket], this.members, [this.closeBracket]));
    };
    return ObjectPropertySyntax;
}(BasePropertySyntax));
exports.ObjectPropertySyntax = ObjectPropertySyntax;
var ObjectMemberSyntax = /** @class */ (function (_super) {
    __extends(ObjectMemberSyntax, _super);
    function ObjectMemberSyntax(name, equal, value, comma) {
        var _this = _super.call(this, SyntaxKind.ObjectMember) || this;
        _this.name = name;
        _this.equal = equal;
        _this.value = value;
        _this.comma = comma;
        assertTokenKind(name, tokens_1.TokenKind.Identifier);
        assertTokenKind(equal, tokens_1.TokenKind.Equal);
        assertTokenKind(value, tokens_1.TokenKind.StringLiteral);
        assertTokenKind(comma, tokens_1.TokenKind.Comma);
        return _this;
    }
    ObjectMemberSyntax.prototype.calculateRange = function () {
        return combineRange(this.name, this.equal, this.value, this.comma);
    };
    return ObjectMemberSyntax;
}(BaseSyntaxNode));
exports.ObjectMemberSyntax = ObjectMemberSyntax;

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9wYXJzaW5nL3N5bnRheC1ub2Rlcy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUE7O0dBRUc7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBRUgsNkNBQTRGO0FBQzVGLDJFQUFvRDtBQUNwRCx5Q0FBa0Q7QUFFbEQsSUFBWSxVQWdCWDtBQWhCRCxXQUFZLFVBQVU7SUFDcEIsWUFBWTtJQUNaLG1EQUFRLENBQUE7SUFDUixpREFBTyxDQUFBO0lBQ1AsNkNBQUssQ0FBQTtJQUVMLFVBQVU7SUFDViwrREFBYyxDQUFBO0lBRWQsU0FBUztJQUNULDZEQUFhLENBQUE7SUFDYixxREFBUyxDQUFBO0lBRVQsVUFBVTtJQUNWLCtEQUFjLENBQUE7SUFDZCwyREFBWSxDQUFBO0FBQ2QsQ0FBQyxFQWhCVyxVQUFVLEdBQVYsa0JBQVUsS0FBVixrQkFBVSxRQWdCckI7QUFFRCxTQUFTLGVBQWUsQ0FBQyxLQUF3QjtJQUFFLHVCQUE2QjtTQUE3QixVQUE2QixFQUE3QixxQkFBNkIsRUFBN0IsSUFBNkI7UUFBN0Isc0NBQTZCOztJQUM5RSxJQUFJLEtBQUssSUFBSSxLQUFLLENBQUMsSUFBSSxLQUFLLGtCQUFTLENBQUMsT0FBTyxJQUFJLENBQUMsYUFBYSxDQUFDLFFBQVEsQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLEVBQUU7UUFDcEYsTUFBTSxJQUFJLEtBQUssQ0FBQyw0Q0FBMEMsNEJBQW1CLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxZQUFTLENBQUMsQ0FBQztLQUNyRztBQUNILENBQUM7QUFFRCxTQUFTLFlBQVk7SUFBQyxlQUFnRDtTQUFoRCxVQUFnRCxFQUFoRCxxQkFBZ0QsRUFBaEQsSUFBZ0Q7UUFBaEQsMEJBQWdEOztJQUNwRSxJQUFNLFdBQVcsR0FBRyxLQUFLLENBQUMsTUFBTSxDQUFDLFVBQUEsSUFBSSxJQUFJLE9BQUEsQ0FBQyxDQUFDLElBQUksRUFBTixDQUFNLENBQUMsQ0FBQyxHQUFHLENBQUMsVUFBQSxJ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LEdBQUssSUFBSSxDQUFDLE9BQU8sR0FBRSxJQUFJLENBQUMsWUFBWSxJQUFFO0lBQzVFLENBQUM7SUFDSCwyQkFBQztBQUFELENBaEJBLEFBZ0JDLENBaEJ5QyxrQkFBa0IsR0FnQjNEO0FBaEJZLG9EQUFvQjtBQWtCakM7SUFBd0Msc0NBQWM7SUFDcEQsNEJBQ2tCLElBQXFCLEVBQ3JCLEtBQXNCLEVBQ3RCLEtBQXNCLEVBQ3RCLEtBQWtDO1FBSnBELFlBTUUsa0JBQU0sVUFBVSxDQUFDLFlBQVksQ0FBQyxTQUsvQjtRQVZpQixVQUFJLEdBQUosSUFBSSxDQUFpQjtRQUNyQixXQUFLLEdBQUwsS0FBSyxDQUFpQjtRQUN0QixXQUFLLEdBQUwsS0FBSyxDQUFpQjtRQUN0QixXQUFLLEdBQUwsS0FBSyxDQUE2QjtRQUdsRCxlQUFlLENBQUMsSUFBSSxFQUFFLGtCQUFTLENBQUMsVUFBVSxDQUFDLENBQUM7UUFDNUMsZUFBZSxDQUFDLEtBQUssRUFBRSxrQkFBUyxDQUFDLEtBQUssQ0FBQyxDQUFDO1FBQ3hDLGVBQWUsQ0FBQyxLQUFLLEVBQUUsa0JBQVMsQ0FBQyxhQUFhLENBQUMsQ0FBQztRQUNoRCxlQUFlLENBQUMsS0FBSyxFQUFFLGtCQUFTLENBQUMsS0FBSyxDQUFDLENBQUM7O0lBQzFDLENBQUM7SUFFUywyQ0FBYyxHQUF4QjtRQUNFLE9BQU8sWUFBWSxDQUFDLElBQUksQ0FBQyxJQUFJLEVBQUUsSUFBSSxDQUFDLEtBQUssRUFBRSxJQUFJLENBQUMsS0FBSyxFQUFFLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQztJQUNyRSxDQUFDO0lBQ0gseUJBQUM7QUFBRCxDQWpCQSxBQWlCQyxDQWpCdUMsY0FBYyxHQWlCckQ7QUFqQlksZ0RBQWtCIiwiZmlsZSI6InNyYy9wYXJzaW5nL3N5bnRheC1ub2Rlcy5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qIVxuICogQ29weXJpZ2h0IDIwMTkgT21hciBUYXdmaWsuIFBsZWFzZSBzZWUgTElDRU5TRSBmaWxlIGF0IHRoZSByb290IG9mIHRoaXMgcmVwb3NpdG9yeS5cbiAqL1xuXG5pbXBvcnQgeyBUb2tlbiwgVG9rZW5LaW5kLCBnZXRUb2tlbkRlc2NyaXB0aW9uLCBUb2tlbldpdGhUcml2aWEgfSBmcm9tIFwiLi4vc2Nhbm5pbmcvdG9rZW5zXCI7XG5pbXBvcnQgeyBSYW5nZSB9IGZyb20gXCJ2c2NvZGUtbGFuZ3VhZ2VzZXJ2ZXItdHlwZXNcIjtcbmltcG9ydCB7IGNvbXBhcmVQb3NpdGlvbnMgfSBmcm9tIFwiLi4vdXRpbC9yYW5nZXNcIjtcblxuZXhwb3J0IGVudW0gU3ludGF4S2luZCB7XG4gIC8vIFRvcCBsZXZlbFxuICBEb2N1bWVudCxcbiAgVmVyc2lvbixcbiAgQmxvY2ssXG5cbiAgLy8gU3RyaW5nc1xuICBTdHJpbmdQcm9wZXJ0eSxcblxuICAvLyBBcnJheXNcbiAgQXJyYXlQcm9wZXJ0eSxcbiAgQXJyYXlJdGVtLFxuXG4gIC8vIE9iamVjdHNcbiAgT2JqZWN0UHJvcGVydHksXG4gIE9iamVjdE1lbWJlcixcbn1cblxuZnVuY3Rpb24gYXNzZXJ0VG9rZW5LaW5kKHRva2VuOiBUb2tlbiB8IHVuZGVmaW5lZCwgLi4uYWNjZXB0ZWRLaW5kczogVG9rZW5LaW5kW10pOiB2b2lkIHtcbiAgaWYgKHRva2VuICYmIHRva2VuLmtpbmQgIT09IFRva2VuS2luZC5NaXNzaW5nICYmICFhY2NlcHRlZEtpbmRzLmluY2x1ZGVzKHRva2VuLmtpbmQpKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKGBUb2tlbiB3YXMgaW5pdGlhbGl6ZWQgd2l0aCBhbiBpbnZhbGlkICcke2dldFRva2VuRGVzY3JpcHRpb24odG9rZW4ua2luZCl9JyBraW5kLmApO1xuICB9XG59XG5cbmZ1bmN0aW9uIGNvbWJpbmVSYW5nZSguLi5pdGVtczogKFRva2VuIHwgQmFzZVN5bnRheE5vZGUgfCB1bmRlZmluZWQpW10pOiBSYW5nZSB7XG4gIGNvbnN0IHZhbGlkUmFuZ2VzID0gaXRlbXMuZmlsdGVyKGl0ZW0gPT4gISFpdGVtKS5tYXAoaXRlbSA9PiBpdGVtIS5yYW5nZSk7XG4gIGlmICghdmFsaWRSYW5nZXMubGVuZ3RoKSB7XG4gICAgcmV0dXJuIFJhbmdlLmNyZWF0ZSgwLCAwLCAwLCAwKTtcbiAgfVxuXG4gIHZhbGlkUmFuZ2VzLnNvcnQoKGEsIGIpID0+IGNvbXBhcmVQb3NpdGlvbnMoYS5zdGFydCwgYi5zdGFydCkpO1xuICByZXR1cm4gUmFuZ2UuY3JlYXRlKHZhbGlkUmFuZ2VzWzBdLnN0YXJ0LCB2YWxpZFJhbmdlc1t2YWxpZFJhbmdlcy5sZW5ndGggLSAxXS5lbmQpO1xufVxuXG5leHBvcnQgYWJzdHJhY3QgY2xhc3MgQmFzZVN5bnRheE5vZGUge1xuICBwcml2YXRlIGxhenlSYW5nZTogUmFuZ2UgfCB1bmRlZmluZWQ7XG5cbiAgcHJvdGVjdGVkIGNvbnN0cnVjdG9yKHB1YmxpYyByZWFkb25seSBraW5kOiBTeW50YXhLaW5kKSB7fVxuXG4gIHB1YmxpYyBnZXQgcmFuZ2UoKTogUmFuZ2Uge1xuICAgIGlmICghdGhpcy5sYXp5UmFuZ2UpIHtcbiAgICAgIHRoaXMubGF6eVJhbmdlID0gdGhpcy5jYWxjdWxhdGVSYW5nZSgpO1xuICAgIH1cbiAgICByZXR1cm4gdGhpcy5sYXp5UmFuZ2U7XG4gIH1cblxuICBwcm90ZWN0ZWQgYWJzdHJhY3QgY2FsY3VsYXRlUmFuZ2UoKTogUmFuZ2U7XG59XG5cbmV4cG9ydCBjbGFzcyBEb2N1bWVudFN5bnRheCBleHRlbmRzIEJhc2VTeW50YXhOb2RlIHtcbiAgcHVibGljIGNvbnN0cnVjdG9yKFxuICAgIHB1YmxpYyByZWFkb25seSB2ZXJzaW9uczogUmVhZG9ubHlBcnJheTxWZXJzaW9uU3ludGF4PixcbiAgICBwdWJsaWMgcmVhZG9ubHkgYmxvY2tzOiBSZWFkb25seUFycmF5PEJsb2NrU3ludGF4PixcbiAgICBwdWJsaWMgcmVhZG9ubHkgY29tbWVudHNBZnRlcjogUmVhZG9ubHlBcnJheTxUb2tlbldpdGhUcml2aWE+LFxuICApIHtcbiAgICBzdXBlcihTeW50YXhLaW5kLkRvY3VtZW50KTtcbiAgfVxuXG4gIHByb3RlY3RlZCBjYWxjdWxhdGVSYW5nZSgpOiBSYW5nZSB7XG4gICAgcmV0dXJuIGNvbWJpbmVSYW5nZSguLi50aGlzLnZlcnNpb25zLCAuLi50aGlzLmJsb2NrcywgLi4udGhpcy5jb21tZW50c0FmdGVyKTtcbiAgfVxufVxuXG5leHBvcnQgY2xhc3MgVmVyc2lvblN5bnRheCBleHRlbmRzIEJhc2VTeW50YXhOb2RlIHtcbiAgcHVibGljIGNvbnN0cnVjdG9yKFxuICAgIHB1YmxpYyByZWFkb25seSB2ZXJzaW9uOiBUb2tlbldpdGhUcml2aWEsXG4gICAgcHVibGljIHJlYWRvbmx5IGVxdWFsOiBUb2tlbldpdGhUcml2aWEsXG4gICAgcHVibGljIHJlYWRvbmx5IGludGVnZXI6IFRva2VuV2l0aFRyaXZpYSxcbiAgKSB7XG4gICAgc3VwZXIoU3ludGF4S2luZC5WZXJzaW9uKTtcbiAgICBhc3NlcnRUb2tlbktpbmQodmVyc2lvbiwgVG9rZW5LaW5kLlZlcnNpb25LZXl3b3JkKTtcbiAgICBhc3NlcnRUb2tlbktpbmQoZXF1YWwsIFRva2VuS2luZC5FcXVhbCk7XG4gICAgYXNzZXJ0VG9rZW5LaW5kKGludGVnZXIsIFRva2VuS2luZC5JbnRlZ2VyTGl0ZXJhbCk7XG4gIH1cblxuICBwcm90ZWN0ZWQgY2FsY3VsYXRlUmFuZ2UoKTogUmFuZ2Uge1xuICAgIHJldHVybiBjb21iaW5lUmFuZ2UodGhpcy52ZXJzaW9uLCB0aGlzLmVxdWFsLCB0aGlzLmludGVnZXIpO1xuICB9XG59XG5cbmV4cG9ydCBjbGFzcyBCbG9ja1N5bnRheCBleHRlbmRzIEJhc2VTeW50YXhOb2RlIHtcbiAgcHVibGljIGNvbnN0cnVjdG9yKFxuICAgIHB1YmxpYyByZWFkb25seSB0eXBlOiBUb2tlbldpdGhUcml2aWEsXG4gICAgcHVibGljIHJlYWRvbmx5IG5hbWU6IFRva2VuV2l0aFRyaXZpYSxcbiAgICBwdWJsaWMgcmVhZG9ubHkgb3BlbkJyYWNrZXQ6IFRva2VuV2l0aFRyaXZpYSxcbiAgICBwdWJsaWMgcmVhZG9ubHkgcHJvcGVydGllczogUmVhZG9ubHlBcnJheTxCYXNlUHJvcGVydHlTeW50YXg+LFxuICAgIHB1YmxpYyByZWFkb25seSBjbG9zZUJyYWNrZXQ6IFRva2VuV2l0aFRyaXZpYSxcbiAgKSB7XG4gICAgc3VwZXIoU3ludGF4S2luZC5CbG9jayk7XG4gICAgYXNzZXJ0VG9rZW5LaW5kKHR5cGUsIFRva2VuS2luZC5BY3Rpb25LZXl3b3JkLCBUb2tlbktpbmQuV29ya2Zsb3dLZXl3b3JkKTtcbiAgICBhc3NlcnRUb2tlbktpbmQobmFtZSwgVG9rZW5LaW5kLlN0cmluZ0xpdGVyYWwpO1xuICAgIGFzc2VydFRva2VuS2luZChvcGVuQnJhY2tldCwgVG9rZW5LaW5kLkxlZnRDdXJseUJyYWNrZXQpO1xuICAgIGFzc2VydFRva2VuS2luZChjbG9zZUJyYWNrZXQsIFRva2VuS2luZC5SaWdodEN1cmx5QnJhY2tldCk7XG4gIH1cblxuICBwcm90ZWN0ZWQgY2FsY3VsYXRlUmFuZ2UoKTogUmFuZ2Uge1xuICAgIHJldHVybiBjb21iaW5lUmFuZ2UodGhpcy50eXBlLCB0aGlzLm5hbWUsIHRoaXMub3BlbkJyYWNrZXQsIC4uLnRoaXMucHJvcGVydGllcywgdGhpcy5jbG9zZUJyYWNrZXQpO1xuICB9XG59XG5cbmV4cG9ydCBhYnN0cmFjdCBjbGFzcyBCYXNlUHJvcGVydHlTeW50YXggZXh0ZW5kcyBCYXNlU3ludGF4Tm9kZSB7XG4gIHByb3RlY3RlZCBjb25zdHJ1Y3RvcihcbiAgICBraW5kOiBTeW50YXhLaW5kLFxuICAgIHB1YmxpYyByZWFkb25seSBrZXk6IFRva2VuV2l0aFRyaXZpYSxcbiAgICBwdWJsaWMgcmVhZG9ubHkgZXF1YWw6IFRva2VuV2l0aFRyaXZpYSxcbiAgKSB7XG4gICAgc3VwZXIoa2luZCk7XG4gICAgYXNzZXJ0VG9rZW5LaW5kKFxuICAgICAga2V5LFxuICAgICAgVG9rZW5LaW5kLk9uS2V5d29yZCxcbiAgICAgIFRva2VuS2luZC5SZXNvbHZlc0tleXdvcmQsXG4gICAgICBUb2tlbktpbmQuVXNlc0tleXdvcmQsXG4gICAgICBUb2tlbktpbmQuTmVlZHNLZXl3b3JkLFxuICAgICAgVG9rZW5LaW5kLlJ1bnNLZXl3b3JkLFxuICAgICAgVG9rZW5LaW5kLkFyZ3NLZXl3b3JkLFxuICAgICAgVG9rZW5LaW5kLkVudktleXdvcmQsXG4gICAgICBUb2tlbktpbmQuU2VjcmV0c0tleXdvcmQsXG4gICAgKTtcbiAgICBhc3NlcnRUb2tlbktpbmQoZXF1YWwsIFRva2VuS2luZC5FcXVhbCk7XG4gIH1cbn1cblxuZXhwb3J0IGNsYXNzIFN0cmluZ1Byb3BlcnR5U3ludGF4IGV4dGVuZHMgQmFzZVByb3BlcnR5U3ludGF4IHtcbiAgcHVibGljIGNvbnN0cnVjdG9yKGtleTogVG9rZW5XaXRoVHJpdmlhLCBlcXVhbDogVG9rZW5XaXRoVHJpdmlhLCBwdWJsaWMgcmVhZG9ubHkgdmFsdWU6IFRva2VuV2l0aFRyaXZpYSB8IHVuZGVmaW5lZCkge1xuICAgIHN1cGVyKFN5bnRheEtpbmQuU3RyaW5nUHJvcGVydHksIGtleSwgZXF1YWwpO1xuICAgIGFzc2VydFRva2VuS2luZCh2YWx1ZSwgVG9rZW5LaW5kLlN0cmluZ0xpdGVyYWwpO1xuICB9XG5cbiAgcHJvdGVjdGVkIGNhbGN1bGF0ZVJhbmdlKCk6IFJhbmdlIHtcbiAgICByZXR1cm4gY29tYmluZVJhbmdlKHRoaXMua2V5LCB0aGlzLmVxdWFsLCB0aGlzLnZhbHVlKTtcbiAgfVxufVxuXG5leHBvcnQgY2xhc3MgQXJyYXlQcm9wZXJ0eVN5bnRheCBleHRlbmRzIEJhc2VQcm9wZXJ0eVN5bnRheCB7XG4gIHB1YmxpYyBjb25zdHJ1Y3RvcihcbiAgICBrZXk6IFRva2VuV2l0aFRyaXZpYSxcbiAgICBlcXVhbDogVG9rZW5XaXRoVHJpdmlhLFxuICAgIHB1YmxpYyByZWFkb25seSBvcGVuQnJhY2tldDogVG9rZW5XaXRoVHJpdmlhLFxuICAgIHB1YmxpYyByZWFkb25seSBpdGVtczogUmVhZG9ubHlBcnJheTxBcnJheUl0ZW1TeW50YXg+LFxuICAgIHB1YmxpYyByZWFkb25seSBjbG9zZUJyYWNrZXQ6IFRva2VuV2l0aFRyaXZpYSxcbiAgKSB7XG4gICAgc3VwZXIoU3ludGF4S2luZC5BcnJheVByb3BlcnR5LCBrZXksIGVxdWFsKTtcbiAgICBhc3NlcnRUb2tlbktpbmQob3BlbkJyYWNrZXQsIFRva2VuS2luZC5MZWZ0U3F1YXJlQnJhY2tldCk7XG4gICAgYXNzZXJ0VG9rZW5LaW5kKGNsb3NlQnJhY2tldCwgVG9rZW5LaW5kLlJpZ2h0U3F1YXJlQnJhY2tldCk7XG4gIH1cblxuICBwcm90ZWN0ZWQgY2FsY3VsYXRlUmFuZ2UoKTogUmFuZ2Uge1xuICAgIHJldHVybiBjb21iaW5lUmFuZ2UodGhpcy5vcGVuQnJhY2tldCwgLi4udGhpcy5pdGVtcywgdGhpcy5jbG9zZUJyYWNrZXQpO1xuICB9XG59XG5cbmV4cG9ydCBjbGFzcyBBcnJheUl0ZW1TeW50YXggZXh0ZW5kcyBCYXNlU3ludGF4Tm9kZSB7XG4gIHB1YmxpYyBjb25zdHJ1Y3RvcihwdWJsaWMgcmVhZG9ubHkgdmFsdWU6IFRva2VuV2l0aFRyaXZpYSwgcHVibGljIHJlYWRvbmx5IGNvbW1hOiBUb2tlbldpdGhUcml2aWEgfCB1bmRlZmluZWQpIHtcbiAgICBzdXBlcihTeW50YXhLaW5kLkFycmF5SXRlbSk7XG4gICAgYXNzZXJ0VG9rZW5LaW5kKHZhbHVlLCBUb2tlbktpbmQuU3RyaW5nTGl0ZXJhbCk7XG4gICAgYXNzZXJ0VG9rZW5LaW5kKGNvbW1hLCBUb2tlbktpbmQuQ29tbWEpO1xuICB9XG5cbiAgcHJvdGVjdGVkIGNhbGN1bGF0ZVJhbmdlKCk6IFJhbmdlIHtcbiAgICByZXR1cm4gY29tYmluZVJhbmdlKHRoaXMudmFsdWUsIHRoaXMuY29tbWEpO1xuICB9XG59XG5cbmV4cG9ydCBjbGFzcyBPYmplY3RQcm9wZXJ0eVN5bnRheCBleHRlbmRzIEJhc2VQcm9wZXJ0eVN5bnRheCB7XG4gIHB1YmxpYyBjb25zdHJ1Y3RvcihcbiAgICBrZXk6IFRva2VuV2l0aFRyaXZpYSxcbiAgICBlcXVhbDogVG9rZW5XaXRoVHJpdmlhLFxuICAgIHB1YmxpYyByZWFkb25seSBvcGVuQnJhY2tldDogVG9rZW5XaXRoVHJpdmlhLFxuICAgIHB1YmxpYyByZWFkb25seSBtZW1iZXJzOiBSZWFkb25seUFycmF5PE9iamVjdE1lbWJlclN5bnRheD4sXG4gICAgcHVibGljIHJlYWRvbmx5IGNsb3NlQnJhY2tldDogVG9rZW5XaXRoVHJpdmlhLFxuICApIHtcbiAgICBzdXBlcihTeW50YXhLaW5kLk9iamVjdFByb3BlcnR5LCBrZXksIGVxdWFsKTtcbiAgICBhc3NlcnRUb2tlbktpbmQob3BlbkJyYWNrZXQsIFRva2VuS2luZC5MZWZ0Q3VybHlCcmFja2V0KTtcbiAgICBhc3NlcnRUb2tlbktpbmQoY2xvc2VCcmFja2V0LCBUb2tlbktpbmQuUmlnaHRDdXJseUJyYWNrZXQpO1xuICB9XG5cbiAgcHJvdGVjdGVkIGNhbGN1bGF0ZVJhbmdlKCk6IFJhbmdlIHtcbiAgICByZXR1cm4gY29tYmluZVJhbmdlKHRoaXMub3BlbkJyYWNrZXQsIC4uLnRoaXMubWVtYmVycywgdGhpcy5jbG9zZUJyYWNrZXQpO1xuICB9XG59XG5cbmV4cG9ydCBjbGFzcyBPYmplY3RNZW1iZXJTeW50YXggZXh0ZW5kcyBCYXNlU3ludGF4Tm9kZSB7XG4gIHB1YmxpYyBjb25zdHJ1Y3RvcihcbiAgICBwdWJsaWMgcmVhZG9ubHkgbmFtZTogVG9rZW5XaXRoVHJpdmlhLFxuICAgIHB1YmxpYyByZWFkb25seSBlcXVhbDogVG9rZW5XaXRoVHJpdmlhLFxuICAgIHB1YmxpYyByZWFkb25seSB2YWx1ZTogVG9rZW5XaXRoVHJpdmlhLFxuICAgIHB1YmxpYyByZWFkb25seSBjb21tYTogVG9rZW5XaXRoVHJpdmlhIHwgdW5kZWZpbmVkLFxuICApIHtcbiAgICBzdXBlcihTeW50YXhLaW5kLk9iamVjdE1lbWJlcik7XG4gICAgYXNzZXJ0VG9rZW5LaW5kKG5hbWUsIFRva2VuS2luZC5JZGVudGlmaWVyKTtcbiAgICBhc3NlcnRUb2tlbktpbmQoZXF1YWwsIFRva2VuS2luZC5FcXVhbCk7XG4gICAgYXNzZXJ0VG9rZW5LaW5kKHZhbHVlLCBUb2tlbktpbmQuU3RyaW5nTGl0ZXJhbCk7XG4gICAgYXNzZXJ0VG9rZW5LaW5kKGNvbW1hLCBUb2tlbktpbmQuQ29tbWEpO1xuICB9XG5cbiAgcHJvdGVjdGVkIGNhbGN1bGF0ZVJhbmdlKCk6IFJhbmdlIHtcbiAgICByZXR1cm4gY29tYmluZVJhbmdlKHRoaXMubmFtZSwgdGhpcy5lcXVhbCwgdGhpcy52YWx1ZSwgdGhpcy5jb21tYSk7XG4gIH1cbn1cbiJdfQ==
